# 网络和图的基本概念

## 网络与图的概念

### 结点与边

**网络（或图）**^[有时候网络专门指有权的连通图，本教程中不区分图和网络]一般由结点和边组成。在心理学的网络分析中，**结点（node或vertex）**代表网络中的个体或实体，如心理特质、症状、因素、社会个体等等。**边（edge）**则表示结点之间的关系或连接，如相关性、因果关系、相互作用、社会关系等。

### 有向图与无向图

**有向图（directed graph）**中的边具有方向性，表示从一个结点指向另一个结点的关系。例如，微博上的关注关系就是有向的。在心理学的研究中，有时使用有向图来表示变量之间的因果关系。**无向图（undirected graph）**中的边没有方向性，表示结点之间的双向关系，如微信上的好友关系。很多临床心理学领域的网络分析就使用的是无向图，例如一个由多个变量之间的相关系数构成的网络就是无向图。下图就是一个关注多个临床心理学症状的网络分析的示例^[Fried, E. I., van Borkulo, C. D., Cramer, A. O. J., Boschloo, L., Schoevers, R. A., & Borsboom, D. (2017). Mental disorders as networks of problems: A review of recent insights. *Social Psychiatry and Psychiatric Epidemiology*, *52*(1), 1–10. https://doi.org/10.1007/s00127-016-1319-z
]。

![A 患者个体的八种症状之间的配对关联；该网络基于时间序列数据，因此是一个有向图。 B 患者群体的八种症状之间的配对关联；该网络基于横断数据，因此是一个无向图。](https://media.springernature.com/lw685/springer-static/image/art%3A10.1007%2Fs00127-016-1319-z/MediaObjects/127_2016_1319_Fig1_HTML.gif?as=webp)

### 有权图与无权图

**有权图（weighted graph）**中的边具有权重，表示关系的强度或容量。例如，一个描述各种心理症状关系的网络中的权重可能是症状之间的偏相关系数。**无权图（unweighted graph）**中的边没有权重，表示关系的存在或不存在。

### 图的表示：邻接矩阵

**邻接矩阵（adjacency matrix）**是一种表示图的方法，其中矩阵的行和列对应于图的结点，矩阵中的元素表示结点之间的边。例如，元素 $A_{ij}$ 表示结点 $i$ 和结点 $j$ 之间是否存在边。在有权图中，$A_{ij}$ 也表示两个结点之间的权重。

例如，一个包括5个结点的网络的邻接矩阵如下：

$$
\begin{bmatrix}
0& 2.5& 0& 0& 7.8\\
0& 0& 3.1& 0& 0\\
0& 0& 0& 4.6& 0\\
0& 0& 0& 0& 5.2\\
0& 0& 0& 0& 0
\end{bmatrix}
$$

可以绘制为这样的一个有向图：

<img src="01-intro_files/figure-html/unnamed-chunk-1-1.png" width="672" />

*当然我们也会发现，对于刚才的邻接矩阵，矩阵中的大部分元素都是0。这样的稀疏矩阵在存储时效率较低，当结点数量很庞大时会占用大量空间（空间复杂度$O(n^2)$）。因此，除了使用邻接矩阵，我们也可以使用**邻接表**等方法表示一个图。*

## 网络的基本性质

### 路径

对于一个图，我们往往会关心一个结点和另一个结点之间的关系，而要研究两个结点之间的关系，就不得不先知道两个结点之间的路径。**路径（path）**是指在图中从一个结点到另一个结点的结点序列。路径的长度由路径上的边数决定。如果路径序列中结点不重复出现，那我们称这个路径为简单路径。路径可以帮助分析网络中结点之间的可达性和距离。在计算结点间的路径时，我们有时还会遇到环。**环（loop）**，又称**回路**，指的是第一个结点和最后一个结点相同的路径。

有时从一个结点到另一个结点的路径可能有很多，但是这些路径之中一定有一个**最短路径**，即路径上边的权重之和最小的路径。而这个最短路径就是两个结点之间的距离。

::: {.rmdnote}
**Dijkstra算法**

Dijkstra算法是荷兰计算机科学家Edsger W. Dijkstra于1956年提出的一种用于计算有权图中最短路径的经典算法。该算法适用于包含非负权重的有向图和无向图。

Dijkstra算法的核心思想是通过贪心策略逐步扩展最近的未处理结点，并更新其邻居结点的距离，直到所有结点的最短路径都确定。具体步骤如下：

1. 初始化：从起始结点开始，设置起始结点到自身的距离为0，其他结点的距离为无穷大。将所有结点标记为未访问。

2. 选择结点：从未访问的结点中选择一个距离起始结点最近的结点作为当前结点。

3. 更新距离：对于当前结点的每个邻居结点，计算从起始结点经过当前结点到达该邻居结点的距离。如果该距离小于当前记录的距离，则更新该邻居结点的距离。

4. 标记访问：将当前结点标记为已访问。

5. 重复：重复步骤2到4，直到所有结点都被访问。
:::

### 连通性

**连通性（connectivity）**描述了图中结点之间的连接程度。如果图中任意两个结点之间都存在路径我们就称这个图是连通的。连通性可以帮助识别网络中的孤立结点和子图。

一个无向图中的极大连通子图称为连通分量（一个图可有多个）。在有向图中，如果对于每一对结点$i$和$j$，从$i$到$j$和从$j$到$i$都存在路径，则称这个图是强连通图。有向图中的极大强连通子图称为强连通分量。

::: {.rmdnote}
**图的遍历**

图的遍历指的是从图中某一结点出发访遍图中其余结点，且使每一个结点被访问且仅被访问一次。图的遍历算法是求解图的连通性问题、拓扑问题等算法的基础。图的遍历通常有两种方法：深度优先搜索（Depth-First Search, DFS）和广度优先搜索（Breadth-First Search, BFS）。

**深度优先搜索**：从图的指定结点$v$出发，先访问结点$v$，并将其标记为已访问过，然后依次从$v$的未被访问过的邻接结点$w$出发进行深度优先搜索，直到图中与$v$相连的所有结点都被访问过。如果图中还有未被访问的结点，则从另一未被访问过的结点出发重复上述过程，直到图中所有结点都被访问过为止。

**广度优先搜索**：从图的指定结点$v$出发，先访问结点$v$，接着依次访问$v$的所有邻结点$w_1$, $w_2$, ... , $w_x$，然后，再依次访问与$w_1$, $w_2$, ..., $w_x$ 邻接的所有未被访问过的结点，以此类推，直到所有已访问结点的邻接结点都被访问过为止。如果图中还有未被访问过的结点，则从另一未被访问过的结点出发进行广度优先搜索，直到所有结点都被访问过为止。
:::

## 结点的基本性质

### 度 

**度（degree）**是指一个结点连接的边的数量。在有向图中，度可以分为**入度（in-degree）**和**出度（out-degree）**，分别表示指向该结点的边数和从该结点出发的边数。

### 中心性

**中心性（centrality）**是衡量结点在网络中重要性的一类指标。常见的中心性指标包括**度中心性（degree centrality）**、**接近中心性（closeness centrality）**、**中介中心性（betweenness centrality）**和**特征向量中心性（eigenvector centrality）**。这些指标可以帮助识别网络中的关键结点。

#### 度中心性

度中心性是衡量一个结点在网络中直接连接到其他结点数量的指标。它是最简单、最直观的中心性度量方法。无向图中的度中心性等于该结点的度，即与该节点直接相连的边的数量。有向图中的度中心性可以进一步分为入度中心性和出度中心性。入度中心性表示指向该结点的边的数量，出度中心性表示从该结点出发的边的数量。

#### 接近中心性

接近中心性衡量一个结点到网络中所有其他结点的平均最短路径长度的倒数。接近中心性高的结点通常位于网络的中心位置，能够更快地与其他结点进行通信。

结点$v$接近中心性的计算公式如下：

$$
\text{Closness Centrality} = \frac{1}{\sum_{i\neq v}d_{vi}}
$$

其中，$i$表示图中非$v$的结点，$d_{vi}$表示结点$v$到结点$i$的最短路径。

#### 中介中心性

中介中心性衡量一个结点在网络中作为其他结点对之间最短路径的中介程度。中介中心性高的结点在网络中起到“桥梁”作用，控制着信息的流动。

结点$v$中介中心性的计算公式如下：

$$
\text{Betweenness Centrality} = \sum_{i \neq j, i \neq v, j \neq  v} \frac{g_{ivj}}{g_{ij}}
$$

其中，$g_{ij}$表示结点$i$到结点$j$的最短路径的数量，$g_{ivj}$表示从$i$到$j$的经过$v$的最短路径的数量。

#### 特征向量中心性

特征向量中心性是一种衡量网络中结点重要性的方法。它不仅考虑结点的直接连接数量，还考虑这些连接结点本身的重要性。换句话说，一个结点的中心性不仅取决于它有多少邻居结点，还取决于这些邻居结点的中心性。

特征向量中心性可以通过计算邻接矩阵的主特征向量来获得。
